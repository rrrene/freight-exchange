<%= semantic_form_for(@freight) do |f| %>
  <% %w(origin destination).each do |site| %>
    <%= render :partial => 'site_info_form_content', :locals => {:f => f, :site => site} %>
  <% end %>
  
  <script type="text/javascript">
    function fillSiteInfo(site, station_id) {
      var station = all_stations[station_id];
      var prefix = "freight";
      for(var i in station) {
        var ele = jQuery("#"+prefix+'_'+site+'_site_info_attributes_'+i);
        if( ele ) {
          ele.val(station[i]);
        }
      }
    }
    var all_stations = {};
    <% Station.all.each do |station| %>
      all_stations['<%= station.id %>'] = {
        <%- %w(name address address2 zip city country).each do |field| -%>
          '<%= field %>': "<%= station[field] %>",
        <%- end -%>
        'country': "<%= station.country.name %>"
      };
    <% end %>
  </script>
  
  <%= f.inputs :freight_description do %>
    <%= f.input :hazmat, :collection => [["yes", true], ["no", false]] %>
    
    <%= localized_info_field f, :goods_text, :en %>
        
    <%= f.input :weight, :as => :string %>
    <%= f.input :transport_type, :collection => collection_choices(Freight, :transport_type), :include_blank => false %>
     
    <%= localized_info_field f, :transport_text, :en %>
    
    <%= f.input :wagons_provided_by, :collection => collection_choices(Freight, :wagons_provided_by), :as => :radio %>
    <%= f.input :desired_proposal_type, :collection => collection_choices(Freight, :desired_proposal_type), :as => :radio %>
  <% end %>
  
  <%= f.buttons %>
<% end %>

<% content_for(:sidebar) do %>
  <%= debug @freight %>
<% end %>